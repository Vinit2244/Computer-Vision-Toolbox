# Faster RCNN Visualization

This repository contains code for visualizing different components of Faster RCNN as part of the assignment. The visualizations help in understanding how the Region Proposal Network (RPN) and ROI Heads work during training.

## Setup

1. Install the required dependencies:
   ```bash
   pip install -r requirements.txt
   ```

2. Update the dataset path in the config file (`config/st.yaml`):
   ```yaml
   dataset_params:
     root_dir: /path/to/your/dataset
     num_classes: 2
   ```

## Running the Visualizations

### Option 1: Run with multiple hyperparameter sets

To run the training with three different hyperparameter sets and generate visualizations:

```bash
python run_visualizations.py --config config/st.yaml --vis-interval 50 --num-epochs 5
```

### Option 2: Run with a single hyperparameter set

To run with a single hyperparameter set:

```bash
python train_with_visualization.py --config config/st.yaml --vis-interval 50
```

## Visualization Outputs

The visualizations will be saved in the `visualizations/` directory, organized by hyperparameter set. For each set, the following visualizations are generated:

1. **Objectness Maps**: Heatmaps showing the probability of an object being present at each location
2. **Object Proposals**: Bounding box proposals generated by the RPN
3. **Anchor Assignments**: Positive (green) and negative (red) anchors during RPN training
4. **ROI Predictions**: Comparison between RPN proposals (blue) and final predictions (green)

Animations are automatically created from the visualizations to show how these components evolve during training.

## Understanding the Results

For a detailed explanation of the changes made and how to interpret the visualizations, please refer to the [changes.md](changes.md) file.

## Hyperparameter Sets

The code runs with three different hyperparameter sets to observe their effects on the model:

1. **Default Values**
2. **Higher IoU Thresholds**
3. **Different Batch Sizes and Positive Fractions**

The specific values for each set can be found in the [changes.md](changes.md) file. 